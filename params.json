{
  "name": "qdnguyen.github.io",
  "tagline": "demo for geoid",
  "body": "\r\n<!DOCTYPE html>\r\n<!--\r\nTo change this license header, choose License Headers in Project Properties.\r\nTo change this template file, choose Tools | Templates\r\nand open the template in the editor.\r\n-->\r\n<html>\r\n    <head>\r\n        <title>Globe</title>\r\n\r\n\t<style type=\"text/css\">\r\n            html {height: 100%}\r\n\t    body { margin: 0; overflow:hidden; height:100%}\r\n\r\n            #viewerDiv {\r\n                margin : auto auto;\r\n                width: 100%;\r\n                height: 100%;\r\n                padding: 0;\r\n                /*margin-top: 50vh;\r\n                transform: translateY(-50%);*/\r\n            }\r\n            #menuDiv {position: absolute; top:0px; margin-left: 0px;}\r\n\r\n\r\n        </style>\r\n        <meta charset=\"UTF-8\">\r\n\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n        <script src=\"https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5.1/dat.gui.min.js\"></script>\r\n    </head>\r\n    <body>\r\n        <div id=\"viewerDiv\"></div>\r\n        <script src=\"dist/itowns2.js\"> </script>\r\n        <script type=\"text/javascript\">\r\n\r\n               var initCenter = { longitude:2.3465, latitude: 48.88, altitude: 25000000};\r\n\r\n               // iTowns namespace defined here\r\n\r\n               var viewerDiv = document.getElementById(\"viewerDiv\");\r\n\r\n               itowns.viewer.createSceneGlobe(initCenter, viewerDiv, {atmosphere:true, zFactor:1, elevationZooms: [14,11,7,3]}) ;\r\n               //console.log(itowns.viewer.pickPosition());\r\n\r\n              itowns.viewer.addImageryLayer({\r\n                protocol:   \"wmts\",\r\n                id:         \"Ortho\",\r\n                url:        \"http://wxs.ign.fr/va5orxd0pgzvq3jxutqfuy0b/geoportail/wmts\",\r\n                options: {\r\n                        //name:'GEOGRAPHICALGRIDSYSTEMS.MAPS',\r\n                        name: \"ORTHOIMAGERY.ORTHOPHOTOS\",\r\n                        mimetype: \"image/jpeg\",\r\n                        tileMatrixSet: \"PM\",\r\n                        tileMatrixSetLimits: {\r\n                           /* \"0\": {\r\n                                \"minTileRow\": 0,\r\n                                \"maxTileRow\": 1,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 1\r\n                            },\r\n                            \"1\": {\r\n                                \"minTileRow\": 0,\r\n                                \"maxTileRow\": 2,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 2\r\n                            },*/\r\n                            \"2\": {\r\n                                \"minTileRow\": 0,\r\n                                \"maxTileRow\": 4,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 4\r\n                            },\r\n                            \"3\": {\r\n                                \"minTileRow\": 0,\r\n                                \"maxTileRow\": 8,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 8\r\n                            },\r\n                            \"4\": {\r\n                                \"minTileRow\": 0,\r\n                                \"maxTileRow\": 6,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 16\r\n                            },\r\n                            \"5\": {\r\n                                \"minTileRow\": 0,\r\n                                \"maxTileRow\": 32,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 32\r\n                            },\r\n                            \"6\": {\r\n                                \"minTileRow\": 1,\r\n                                \"maxTileRow\": 64,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 64\r\n                            },\r\n                            \"7\": {\r\n                                \"minTileRow\": 3,\r\n                                \"maxTileRow\": 28,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 128\r\n                            },\r\n                            \"8\": {\r\n                                \"minTileRow\": 7,\r\n                                \"maxTileRow\": 256,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 256\r\n                            },\r\n                            \"9\": {\r\n                                \"minTileRow\": 15,\r\n                                \"maxTileRow\": 512,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 512\r\n                            },\r\n                            \"10\": {\r\n                                \"minTileRow\": 31,\r\n                                \"maxTileRow\": 1024,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 1024\r\n                            },\r\n                            \"11\": {\r\n                                \"minTileRow\": 62,\r\n                                \"maxTileRow\": 2048,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 2048\r\n                            },\r\n                            \"12\": {\r\n                                \"minTileRow\": 125,\r\n                                \"maxTileRow\": 4096,\r\n                                \"minTileCol\": 0,\r\n                                \"maxTileCol\": 4096\r\n                            },\r\n                            \"13\": {\r\n                                \"minTileRow\": 2739,\r\n                                \"maxTileRow\": 4628,\r\n                                \"minTileCol\": 41,\r\n                                \"maxTileCol\": 7917\r\n                            },\r\n                            \"14\": {\r\n                                \"minTileRow\": 5478,\r\n                                \"maxTileRow\": 9256,\r\n                                \"minTileCol\": 82,\r\n                                \"maxTileCol\": 15835\r\n                            },\r\n                            \"15\": {\r\n                                \"minTileRow\": 10956,\r\n                                \"maxTileRow\": 8513,\r\n                                \"minTileCol\": 165,\r\n                                \"maxTileCol\": 31670\r\n                            },\r\n                            \"16\": {\r\n                                \"minTileRow\": 21912,\r\n                                \"maxTileRow\": 37026,\r\n                                \"minTileCol\": 330,\r\n                                \"maxTileCol\": 63341\r\n                            },\r\n                            \"17\": {\r\n                                \"minTileRow\": 43825,\r\n                                \"maxTileRow\": 74052,\r\n                                \"minTileCol\": 660,\r\n                                \"maxTileCol\": 126683\r\n                            },\r\n                            \"18\": {\r\n                                \"minTileRow\": 87651,\r\n                                \"maxTileRow\": 48105,\r\n                                \"minTileCol\": 1320,\r\n                                \"maxTileCol\": 253366\r\n                            },\r\n                            \"19\": {\r\n                                \"minTileRow\": 175302,\r\n                                \"maxTileRow\": 294060,\r\n                                \"minTileCol\": 170159,\r\n                                \"maxTileCol\": 343473\r\n                            },\r\n                            \"20\": {\r\n                                \"minTileRow\": 376733,\r\n                                \"maxTileRow\": 384679,\r\n                                \"minTileCol\": 530773,\r\n                                \"maxTileCol\": 540914\r\n                                }\r\n                        }\r\n                    }\r\n                });\r\n\r\n\r\n                itowns.viewer.addImageryLayer({\r\n                protocol:   \"wmts\",\r\n                id:         \"OrthoCRS\",\r\n                url:        \"http://wxs.ign.fr/va5orxd0pgzvq3jxutqfuy0b/geoportail/wmts\",\r\n                fx :        1.0,\r\n                options: {\r\n                        name: 'ORTHOIMAGERY.ORTHOPHOTOS.CRS84',\r\n                        mimetype: \"image/jpeg\",\r\n                        tileMatrixSet: \"WGS84G\",\r\n                        tileMatrixSetLimits: {\r\n\r\n                            '6' : {\r\n                                'minTileRow' : 13,\r\n                                'maxTileRow' : 39,\r\n                                'minTileCol' : 0,\r\n                                'maxTileCol' : 83,\r\n                            },\r\n                            '7' : {\r\n                                'minTileRow' : 27,\r\n                                'maxTileRow' : 79,\r\n                                'minTileCol' : 1,\r\n                                'maxTileCol' : 167,\r\n                            },\r\n                            '8' : {\r\n                                'minTileRow' : 55,\r\n                                'maxTileRow' : 158,\r\n                                'minTileCol' : 2,\r\n                                'maxTileCol' : 335,\r\n                            },\r\n                            '9' : {\r\n                                'minTileRow' : 110,\r\n                                'maxTileRow' : 316,\r\n                                'minTileCol' : 5,\r\n                                'maxTileCol' : 670\r\n                            },\r\n                            '10' : {\r\n                                'minTileRow' : 221,\r\n                                'maxTileRow' : 633,\r\n                                'minTileCol' : 10,\r\n                                'maxTileCol' : 1341,\r\n                            },\r\n                            '11' : {\r\n                                'minTileRow' : 442,\r\n                                'maxTileRow' : 1267,\r\n                                'minTileCol' : 20,\r\n                                'maxTileCol' : 2683,\r\n                            },\r\n                            '12' : {\r\n                                'minTileRow' : 885,\r\n                                'maxTileRow' : 2534,\r\n                                'minTileCol' : 41,\r\n                                'maxTileCol' : 5366,\r\n                            },\r\n                            '13' : {\r\n                                'minTileRow' : 1770,\r\n                                'maxTileRow' : 5069,\r\n                                'minTileCol' : 82,\r\n                                'maxTileCol' : 10733,\r\n                            },\r\n                            '14' : {\r\n                                'minTileRow' : 3541,\r\n                                'maxTileRow' : 10139,\r\n                                'minTileCol' : 165,\r\n                                'maxTileCol' : 21467,\r\n                            },\r\n                            '15' : {\r\n                                'minTileRow' : 7082,\r\n                                'maxTileRow' : 20279,\r\n                                'minTileCol' : 330,\r\n                                'maxTileCol' : 42934,\r\n                            },\r\n                            '16' : {\r\n                                'minTileRow' : 14165,\r\n                                'maxTileRow' : 40559,\r\n                                'minTileCol' : 660,\r\n                                'maxTileCol' : 85868,\r\n                            },\r\n                            '17' : {\r\n                                'minTileRow' : 28330,\r\n                                'maxTileRow' : 81118,\r\n                                'minTileCol' : 1320,\r\n                                'maxTileCol' : 171736,\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                itowns.viewer.addImageryLayer({\r\n                protocol:   \"wmts\",\r\n                id:         \"ScanEX\",\r\n                url:        \"http://wxs.ign.fr/va5orxd0pgzvq3jxutqfuy0b/geoportail/wmts\",\r\n                fx :        2.5,\r\n                options: {\r\n                        //name:'GEOGRAPHICALGRIDSYSTEMS.MAPS',\r\n                        // name: 'GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.ROUTIER',\r\n                        name: 'GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD',\r\n                        //name: \"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.NIVEAUXGRIS\",\r\n                        //mimetype: \"image/png\",\r\n                        mimetype: \"image/jpeg\",\r\n\r\n                        tileMatrixSet: \"PM\",\r\n                        tileMatrixSetLimits: {\r\n                          '6' : {\r\n                            'minTileRow': 21,\r\n                            'maxTileRow': 35,\r\n                            'minTileCol':20,\r\n                            'maxTileCol':41\r\n                          },\r\n                          '7' : {\r\n                            'minTileRow': 42,\r\n                            'maxTileRow': 71,\r\n                            'minTileCol':41,\r\n                            'maxTileCol':83\r\n                          },\r\n                          '8' : {\r\n                            'minTileRow': 85,\r\n                            'maxTileRow': 143,\r\n                            'minTileCol':82,\r\n                            'maxTileCol':167\r\n                          },\r\n                          '9' : {\r\n                            'minTileRow': 170,\r\n                            'maxTileRow': 287,\r\n                            'minTileCol':165,\r\n                            'maxTileCol':335\r\n                          },\r\n                          '10' : {\r\n                            'minTileRow': 340,\r\n                            'maxTileRow': 574,\r\n                            'minTileCol': 331,\r\n                            'maxTileCol': 671\r\n                          },\r\n                          '11' : {\r\n                            'minTileRow': 681,\r\n                            'maxTileRow': 1149,\r\n                            'minTileCol':663,\r\n                            'maxTileCol':1342\r\n                          },\r\n                          '12' : {\r\n                            'minTileRow': 1363,\r\n                            'maxTileRow': 2298,\r\n                            'minTileCol':1327,\r\n                            'maxTileCol':2684\r\n                          },\r\n                          '13' : {\r\n                            'minTileRow': 2726,\r\n                            'maxTileRow': 4602,\r\n                            'minTileCol':2655,\r\n                            'maxTileCol':5371\r\n                          },\r\n                          '14' : {\r\n                            'minTileRow': 5452,\r\n                            'maxTileRow': 9204,\r\n                            'minTileCol':5311,\r\n                            'maxTileCol':10742\r\n                          },\r\n                          '15' : {\r\n                            'minTileRow': 10944,\r\n                            'maxTileRow': 18381,\r\n                            'minTileCol':10632,\r\n                            'maxTileCol':21467\r\n                          },\r\n                          '16' : {\r\n                            'minTileRow': 21889,\r\n                            'maxTileRow': 36763,\r\n                            'minTileCol':21264,\r\n                            'maxTileCol':42934\r\n                          },\r\n                          '17' : {\r\n                            'minTileRow': 43778,\r\n                            'maxTileRow': 73526,\r\n                            'minTileCol':42528,\r\n                            'maxTileCol':85869\r\n                          },\r\n                          '18' : {\r\n                            'minTileRow': 87557,\r\n                            'maxTileRow': 147052,\r\n                            'minTileCol':85058,\r\n                            'maxTileCol':171738\r\n                          }\r\n                        }\r\n                    }\r\n                });\r\n\r\n\r\n        // itowns.viewer.addImageryLayer({\r\n        //         protocol:   \"wmtsc\",\r\n        //         id:         \"DARK\",\r\n        //         customUrl:  \"http://a.basemaps.cartocdn.com/dark_all/%TILEMATRIX/%COL/%ROW.png\",\r\n        //         options: { tileMatrixSet: \"PM\"}\r\n        //     });\r\n\r\n        // itowns.viewer.addImageryLayer({\r\n        //     protocol:   \"wmtsc\",\r\n        //     id:         \"OPENSM\",\r\n        //     customUrl:  'http://b.tile.openstreetmap.fr/osmfr/%TILEMATRIX/%COL/%ROW.png',\r\n        //     options: { tileMatrixSet: \"PM\"},\r\n        //     fx :        2.5,\r\n        // });\r\n\r\n        itowns.viewer.addImageryLayer({\r\n                                        url       : \"https://wxs.ign.fr/gratuit/geoportail/v/wms\",\r\n                                        protocol  : 'wms',\r\n                                        version   : '1.3.0',\r\n                                        id        : 'testwms',\r\n                                        name      : 'REGION.2016',\r\n                                        style      : \"\",\r\n                                        projection : \"EPSG:4326\",\r\n                                        transparent : true,\r\n                                        // min long, min lat, max long, max lat\r\n                                        bbox      : [-61.80983300000002, -21.38963079935857, 55.83665389999998, 51.0890011990783],\r\n                                        featureInfoMimeType : \"\",\r\n                                        dateTime  : \"\",\r\n                                        heightMapWidth : 256,\r\n                                        waterMask      : false,\r\n                                        options: {\r\n                                            mimetype  : \"image/png\",\r\n                                            tileMatrixSet: 'WGS84G'\r\n                                        }\r\n                                    });\r\n\r\n        itowns.viewer.addElevationLayer({\r\n            protocol:   \"wmts\",\r\n            id:         \"IGN_MNT\",\r\n            url:        \"http://wxs.ign.fr/va5orxd0pgzvq3jxutqfuy0b/geoportail/wmts\",\r\n            noDataValue : -99999,\r\n            options: {\r\n                    name: \"ELEVATION.ELEVATIONGRIDCOVERAGE\",\r\n                    mimetype: \"image/x-bil;bits=32\",\r\n                    tileMatrixSet: \"WGS84G\",\r\n                    tileMatrixSetLimits: {\r\n                         // \"2\": {\r\n                         //    \"minTileRow\": 0,\r\n                         //    \"maxTileRow\": 2,\r\n                         //    \"minTileCol\": 2,\r\n                         //    \"maxTileCol\": 7\r\n                         //  },\r\n                          \"3\": {\r\n                            \"minTileRow\": 1,\r\n                            \"maxTileRow\": 5,\r\n                            \"minTileCol\": 5,\r\n                            \"maxTileCol\": 15\r\n                          },\r\n                          \"4\": {\r\n                            \"minTileRow\": 3,\r\n                            \"maxTileRow\": 10,\r\n                            \"minTileCol\": 10,\r\n                            \"maxTileCol\": 30\r\n                          },\r\n                          \"5\": {\r\n                            \"minTileRow\": 6,\r\n                            \"maxTileRow\": 20,\r\n                            \"minTileCol\": 20,\r\n                            \"maxTileCol\": 61\r\n                          },\r\n                          \"6\": {\r\n                            \"minTileRow\": 13,\r\n                            \"maxTileRow\": 40,\r\n                            \"minTileCol\": 41,\r\n                            \"maxTileCol\": 123\r\n                          },\r\n                          \"7\": {\r\n                            \"minTileRow\": 27,\r\n                            \"maxTileRow\": 80,\r\n                            \"minTileCol\": 82,\r\n                            \"maxTileCol\": 247\r\n                          },\r\n                          \"8\": {\r\n                            \"minTileRow\": 54,\r\n                            \"maxTileRow\": 160,\r\n                            \"minTileCol\": 164,\r\n                            \"maxTileCol\": 494\r\n                          },\r\n                          \"9\": {\r\n                            \"minTileRow\": 108,\r\n                            \"maxTileRow\": 321,\r\n                            \"minTileCol\": 329,\r\n                            \"maxTileCol\": 989\r\n                          },\r\n                          \"10\": {\r\n                            \"minTileRow\": 216,\r\n                            \"maxTileRow\": 642,\r\n                            \"minTileCol\": 659,\r\n                            \"maxTileCol\": 1979\r\n                          },\r\n                          \"11\": {\r\n                            \"minTileRow\": 432,\r\n                            \"maxTileRow\": 1285,\r\n                            \"minTileCol\": 1319,\r\n                            \"maxTileCol\": 3959\r\n                          }\r\n                        }\r\n                }\r\n            });\r\n\r\n        itowns.viewer.addElevationLayer({\r\n            protocol:   \"wmts\",\r\n            id:         \"IGN_MNT_HIGHRES\",\r\n            url:        \"http://wxs.ign.fr/va5orxd0pgzvq3jxutqfuy0b/geoportail/wmts\",\r\n            noDataValue : -99999,\r\n            options: {\r\n                    name: \"ELEVATION.ELEVATIONGRIDCOVERAGE.HIGHRES\",\r\n                    mimetype: \"image/x-bil;bits=32\",\r\n                    tileMatrixSet: \"WGS84G\",\r\n                    tileMatrixSetLimits: {\r\n                          \"6\": {\r\n                            \"minTileRow\": 13,\r\n                            \"maxTileRow\": 36,\r\n                            \"minTileCol\": 62,\r\n                            \"maxTileCol\": 80\r\n                          },\r\n                          \"7\": {\r\n                            \"minTileRow\": 27,\r\n                            \"maxTileRow\": 73,\r\n                            \"minTileCol\": 124,\r\n                            \"maxTileCol\": 160\r\n                          },\r\n                          \"8\": {\r\n                            \"minTileRow\": 55,\r\n                            \"maxTileRow\": 146,\r\n                            \"minTileCol\": 248,\r\n                            \"maxTileCol\": 320\r\n                          },\r\n                          \"9\": {\r\n                            \"minTileRow\": 110,\r\n                            \"maxTileRow\": 292,\r\n                            \"minTileCol\": 497,\r\n                            \"maxTileCol\": 640\r\n                          },\r\n                          \"10\": {\r\n                            \"minTileRow\": 221,\r\n                            \"maxTileRow\": 585,\r\n                            \"minTileCol\": 994,\r\n                            \"maxTileCol\": 1281\r\n                          },\r\n                          \"11\": {\r\n                            \"minTileRow\": 442,\r\n                            \"maxTileRow\": 1171,\r\n                            \"minTileCol\": 1989,\r\n                            \"maxTileCol\": 2563\r\n                          },\r\n                          \"12\": {\r\n                            \"minTileRow\": 885,\r\n                            \"maxTileRow\": 2343,\r\n                            \"minTileCol\": 3978,\r\n                            \"maxTileCol\": 5126\r\n                          },\r\n                          \"13\": {\r\n                            \"minTileRow\": 1770,\r\n                            \"maxTileRow\": 4687,\r\n                            \"minTileCol\": 7957,\r\n                            \"maxTileCol\": 10253\r\n                          },\r\n                          \"14\": {\r\n                            \"minTileRow\": 3540,\r\n                            \"maxTileRow\": 9375,\r\n                            \"minTileCol\": 15914,\r\n                            \"maxTileCol\": 20507\r\n                          }\r\n                        }\r\n                }\r\n            });\r\n\r\n        itowns.viewer.update();\r\n\r\n\r\n\r\n               // THIS IS AN EXAMPLE OF INTERFACE TO INTERACT WITH ITOWNS\r\n               var Menu = function() {\r\n                   this.CloudsIR = false;\r\n                   this.SatelliteAnimation = false;\r\n                   this.RealisticLighting = false;\r\n                   this.StreetLevelImagery = false;\r\n                   this.KML = false;\r\n                   this.AnimateTime = false;\r\n                   this.Orbit = false;\r\n                   this.api = function(){};\r\n                   this.api2 = function(){};\r\n                   this.api3 = function(){};\r\n               };\r\n\r\n               var text = new Menu();\r\n               var gui = new dat.GUI( { autoPlace: false});\r\n               gui.domElement.id = 'menuDiv';\r\n               viewerDiv.appendChild(gui.domElement);\r\n\r\n                var layers = itowns.viewer.getLayers();\r\n                for(var i in layers)\r\n                {\r\n                    var layer = layers[i];\r\n\r\n                    if(layer.options.mimetype != \"image/x-bil;bits=32\")\r\n                    {\r\n\r\n                        text[layer.id] = true;\r\n                        text[layer.id+'_Opacity'] = itowns.viewer.getLayerOpacity(layer.id);\r\n\r\n                        var fnUp = function(myid) {\r\n                            return function() {\r\n                                itowns.viewer.moveLayerUp(myid);\r\n                            }\r\n                        }(layer.id);\r\n                        var fnDown = function(myid) {\r\n                            return function() {\r\n                                itowns.viewer.moveLayerDown(myid);\r\n                            }\r\n                        }(layer.id);\r\n\r\n                        text[layer.id+'_up'] = fnUp;\r\n                        text[layer.id+'_down'] = fnDown;\r\n\r\n                        var onchangeVisibily = function(id)\r\n                        {\r\n                            return function(newValue)\r\n                            {\r\n                                itowns.viewer.setLayerVisibility(id,newValue);\r\n                            };\r\n\r\n                        }(layer.id);\r\n\r\n                        var onchangeOpacity = function(id)\r\n                        {\r\n                            return function(newValue) {\r\n\r\n                                var opacity = Math.max(0,Math.min(newValue, 1.0));\r\n                                itowns.viewer.setLayerOpacity(id, opacity);\r\n\r\n                            };\r\n\r\n                        }(layer.id);\r\n\r\n                        gui.add(text, layer.id).onChange( onchangeVisibily).name(layer.id);\r\n                        gui.add(text, layer.id + '_Opacity').min(0.0).max(1.0).name(' â†’ Opacity').onChange(onchangeOpacity);\r\n                        gui.add(text, layer.id + '_up');\r\n                        gui.add(text, layer.id + '_down');\r\n                    }\r\n                }\r\n\r\n                // gui.add(text, 'KML').onChange(function(newValue) {\r\n                //     itowns.viewer.showKML(newValue);\r\n                // });\r\n\r\n                if(false)\r\n                {\r\n                    var f2 = gui.addFolder('Atmosphere');\r\n\r\n                    f2.open();\r\n\r\n                    f2.add(text, 'CloudsIR').onChange(function(newValue) {\r\n                         itowns.viewer.showClouds(newValue);\r\n                    });\r\n\r\n                    f2.add(text, 'SatelliteAnimation').onChange(function(newValue) {\r\n                         itowns.viewer.showClouds(true, newValue);\r\n                    });\r\n\r\n                    f2.add(text, 'RealisticLighting').onChange(function(newValue) {\r\n                           itowns.viewer.setRealisticLightingOn(newValue);\r\n                    });\r\n\r\n                    f2.add(text, 'AnimateTime').onChange(function(newValue) {\r\n                        itowns.viewer.animateTime(newValue);\r\n                    });\r\n\r\n                    f2.add(text, 'Orbit').onChange(function(newValue) {\r\n                        itowns.viewer.orbit(newValue);\r\n                    });\r\n\r\n\r\n                    f2.add(text, 'StreetLevelImagery').onChange(function(newValue) {\r\n\t\t\t             itowns.viewer.setStreetLevelImageryOn(newValue);\r\n                    });\r\n                }\r\n                viewerDiv.addEventListener('rangeChanged',function(){\r\n\r\n                var controller;\r\n                controller = gui.add(text, 'api');\r\n                if(controller)\r\n                 {\r\n                     controller.onChange(function(value) {\r\n                        // removeLayer('OPENSM');\r\n                        //itowns.viewer.moveLayerUp('OrthoCRS');\r\n\r\n                            //console.log(itowns.viewer.getZoomLevel(\"Ortho\"));\r\n\r\n                    });\r\n\r\n                 }\r\n\r\n                 }, false);\r\n\r\n                var removeLayer= function(nameLayer)\r\n                {\r\n\r\n                    if(itowns.viewer.removeImageryLayer(nameLayer))\r\n                    {\r\n                        var controllerTodelete = [];\r\n\r\n                        for (var i in gui.__controllers) {\r\n\r\n                            var controller = gui.__controllers[i];\r\n\r\n                            if(controller.property === nameLayer || controller.property === nameLayer + '_Opacity')\r\n                                controllerTodelete.push(controller);\r\n                        }\r\n\r\n                        for (var i in controllerTodelete)\r\n                            gui.remove(controllerTodelete[i]);\r\n                    }\r\n                }\r\n\r\n                var controller;\r\n                var layerIdCrs = 'OrthoCRS';\r\n\r\n                // var controller = gui.add(text,'api').name('Up');\r\n\r\n                // if(controller)\r\n                // {\r\n                //     controller.onChange(function(value) {\r\n                //         itowns.viewer.moveLayerUp(layerIdCrs);\r\n                //     });\r\n                // }\r\n\r\n                // controller = gui.add(text,'api2').name('down');\r\n\r\n                // if(controller)\r\n                // {\r\n                //     controller.onChange(function(value) {\r\n                //         itowns.viewer.moveLayerDown(layerIdCrs);\r\n                //     });\r\n                // }\r\n\r\n                // controller = gui.add(text,'api3').name('Remove Layer');\r\n\r\n                // if(controller)\r\n                // {\r\n                //     controller.onChange(function(value) {\r\n                //         itowns.viewer.removeImageryLayer(layerIdCrs);\r\n                //     });\r\n                // }\r\n\r\n                viewerDiv.addEventListener('globe-loaded',function(){\r\n                    console.log(\"Globe Loaded\");\r\n                    //itowns.viewer.setRange(100000);\r\n\r\n                    //itowns.viewer.loadGPX(\"data/ULTRA2009.gpx\");\r\n                    //itowns.viewer.setCenter({longitude:-74,latitude:40,altitude:0});\r\n                    itowns.viewer.loadGeoidData(\"data/champ/vitesses-itrf2014-gnss-schema.txt\");\r\n                } ,\r\n                false);\r\n\r\n                viewerDiv.addEventListener('Layer-removed',function(event){\r\n                    console.log(\"Layer \" + event.layer +  \" removed\");\r\n                } ,\r\n                false);\r\n\r\n                // gui.add(text, 'StreetLevelImagery').onChange(function(newValue) {\r\n                //     itowns.viewer.setStreetLevelImageryOn(newValue);\r\n                // });\r\n\r\n\r\n               {\r\n\t\t\t\t\tvar onchangeZFactor = function(id)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn function(newValue)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\titowns.viewer.setZFactor(id,newValue);\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t};\r\n                    \r\n                    text['ZFactor'] = itowns.viewer.getZFactor(\"IGN_MNT\");\r\n                    gui.add(text, 'ZFactor').min(1.0).max(100.0).onChange(onchangeZFactor(\"IGN_MNT\"));\r\n                    \r\n                    text['ZFactor_HIGHRES'] = itowns.viewer.getZFactor(\"IGN_MNT_HIGHRES\");\r\n                    gui.add(text, 'ZFactor_HIGHRES').min(1.0).max(100.0).onChange(onchangeZFactor(\"IGN_MNT_HIGHRES\"));\r\n                    \r\n                    text['ITRFFactor'] = 1;\r\n                    gui.add(text, 'ITRFFactor').min(1.0).max(100.0).onChange(function(v){ itowns.viewer.setITFRScale(v*10000)});\r\n                }\r\n\r\n               {\r\n\t\t\t\t    var screenshot = function() {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar gfx = itowns.viewer.scene.gfxEngine;\r\n\t\t\t\t\t\tvar tilelength = 4096;\r\n\t\t\t\t\t\tvar fullsize = text.screenshot;\r\n\t\t\t\t\t\tvar tiles   = { width: Math.ceil(fullsize.width/tilelength), height: Math.ceil(fullsize.height/tilelength) };\r\n\t\t\t\t\t\tvar size = gfx.getRenderer().getSize();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\t\t\t\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\t\t\t\t\tcanvas.width = fullsize.width;\r\n\t\t\t\t\t\tcanvas.height = fullsize.height;\r\n\t\t\t\t\t\tconsole.log\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor(var i=0; i<tiles.width; ++i) for(var j=0; j<tiles.height; ++j) {\r\n\t\t\t\t\t\t\tconsole.log('screenshot, tile : ',(i+j*tiles.width)+\"/\"+(tiles.width*tiles.height));\r\n\r\n\t\t\t\t\t\t\tvar x = i*tilelength;\r\n\t\t\t\t\t\t\tvar y = j*tilelength;\r\n\t\t\t\t\t\t\tvar tilesize = { width: Math.min(fullsize.width-x,tilelength), height: Math.min(fullsize.height-y,tilelength) };\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tgfx.width = tilesize.width;\r\n\t\t\t\t\t\t\tgfx.height = tilesize.height;\r\n\t\t\t\t\t\t\tgfx.camera.resize(tilesize.width, tilesize.height);\r\n\t\t\t\t\t\t\tgfx.camera.camera3D.setViewOffset(fullsize.width,fullsize.height, x,y, tilesize.width,tilesize.height);\r\n\t\t\t\t\t\t\tgfx.scene.updateCamera();\r\n\t\t\t\t\t\t\tgfx.renderer.setSize( tilesize.width, tilesize.height );\r\n\t\t\t\t\t\t\tgfx.update();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tctx.drawImage(gfx.renderer.domElement, x, y);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcanvas.toBlob(function(blob) {\r\n\t\t\t\t\t\t\tvar element = document.createElement('a');\r\n\t\t\t\t\t\t\telement.style.display = 'none';\r\n\t\t\t\t\t\t\tvar url = window.URL.createObjectURL(blob);\r\n\t\t\t\t\t\t\telement.setAttribute('href', url);\r\n\t\t\t\t\t\t\telement.setAttribute('download', 'itowns-geoid.png');\r\n\t\t\t\t\t\t\telement.click();\r\n\t\t\t\t\t\t\twindow.URL.revokeObjectURL(blob);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tconsole.log('screenshot : done');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tgfx.width = size.width;\r\n\t\t\t\t\t\tgfx.height = size.height;\r\n\t\t\t\t\t\tgfx.camera.resize(size.width, size.height);\r\n\t\t\t\t\t\tgfx.camera.camera3D.clearViewOffset();\r\n\t\t\t\t\t\tgfx.scene.updateCamera();\r\n\t\t\t\t\t\tgfx.renderer.setSize( size.width, size.height );\r\n\t\t\t\t\t\tgfx.update();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar ss = gui.addFolder('Screenshot');\r\n                    text.screenshot = {\r\n\t\t\t\t\t\twidth: itowns.viewer.scene.gfxEngine.getRenderer().getSize().width,\r\n\t\t\t\t\t\theight: itowns.viewer.scene.gfxEngine.getRenderer().getSize().height,\r\n\t\t\t\t\t\tscreenshot: screenshot\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\tss.add(text.screenshot,'screenshot');\r\n\t\t\t\t\tss.add(text.screenshot,'width');\r\n\t\t\t\t\tss.add(text.screenshot,'height');\r\n               \r\n\t\t\t   }\r\n\r\n\r\n        </script>\r\n    </body>\r\n</html>\r\n\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}